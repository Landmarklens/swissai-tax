version: 1.0
runtime: python311
build:
  commands:
    build:
      - echo "Installing Python dependencies..."
      - python3 -m pip install --upgrade pip
      - python3 -m pip install --no-cache-dir -r backend/requirements.txt
      - echo "Verifying pydantic-settings installation..."
      - python3 -c "import pydantic_settings; print('pydantic-settings installed successfully')"
run:
  runtime-version: 3.11
  command: bash start.sh
  network:
    port: 8000
    env: PORT
  env:
    - name: PORT
      value: "8000"
    - name: PYTHONUNBUFFERED
      value: "1"
    - name: AWS_DEFAULT_REGION
      value: "us-east-1"
    - name: PYTHONPATH
      value: "/app/backend:/app"
    - name: DATABASE_HOST
      value: "webscraping-database.cluster-c9y2u088elix.us-east-1.rds.amazonaws.com"
    - name: DATABASE_PORT
      value: "5432"
    - name: DATABASE_NAME
      value: "swissai_tax"
    - name: DATABASE_USER
      value: "webscrapinguser"
    - name: DATABASE_PASSWORD
      value: "IXq3IC0Uw6StMkBhb4mb"
    - name: S3_BUCKET_NAME
      value: "swissai-tax-documents-1758721021"
    - name: ENCRYPTION_KEY_CREATED_AT
      value: "arn:aws:ssm:us-east-1:445567083171:parameter/swissai-tax/encryption/key-created-at"
    - name: ENCRYPTION_KEY_ROTATION_DAYS
      value: "arn:aws:ssm:us-east-1:445567083171:parameter/swissai-tax/encryption/key-rotation-days"